<!--
	THEME 14: RHYTHMIC by starlightthemes

	Credits:
		Layout and design by SUPERSTAR JYPNATION: https://play.google.com/store/apps/details?id=com.dalcomsoft.ss.jyp
		Phosphor Icons: https://phosphoricons.com/

	Last updated 21 Oct 2024.
-->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>{block:TagPage}{lang:TagResultCount posts tagged Tag} | {/block:TagPage}{block:SearchPage}{lang:SearchResultCount results for SearchQuery}{block:NoSearchResults}{lang:No results for SearchQuery}{/block:NoSearchResults} | {/block:SearchPage}{block:PermalinkPage}{block:PostSummary}{PostSummary} | {/block:PostSummary}{/block:PermalinkPage}{Title}</title>
	<meta name="description" content="{MetaDescription}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="shortcut icon" href="{Favicon}">
	<link rel="apple-touch-icon-precomposed" href="{PortraitURL-128}">
	<link rel="alternate" type="application/rss+xml" href="{RSS}">

	{block:Hidden}
	<!-- THEME VARIABLES -->
	<!-- Text and coloration -->
	<meta name="text:Font size" content="16px">
	<meta name="color:Accent" content="#481f19">

	<!-- Title coloration display option -->
	<meta name="select:Weekly league" content="" title="League unregistered">
	<meta name="select:Weekly league" content="bronze" title="Bronze">
	<meta name="select:Weekly league" content="silver" title="Silver">
	<meta name="select:Weekly league" content="gold" title="Gold">
	<meta name="select:Weekly league" content="platinum" title="Platinum">
	<meta name="select:Weekly league" content="master" title="Master">

	<!-- Image options -->
	<meta name="image:Background" content="{HeaderImage}">
	<meta name="select:Background image focus" content="center" title="Center">
	<meta name="select:Background image focus" content="top" title="Top">
	<meta name="select:Background image focus" content="bottom" title="Bottom">
	<meta name="image:Profile banner" content="{HeaderImage}">
	<meta name="select:Profile banner image focus" content="center" title="Center">
	<meta name="select:Profile banner image focus" content="top" title="Top">
	<meta name="select:Profile banner image focus" content="bottom" title="Bottom">

	<!-- Top navigation options -->
	<meta name="if:Random post link" content="1">
	<meta name="if:Archive link" content="1">

	<!-- User profile options -->
	<meta name="text:Status message" content="Say what you want!">
	<meta name="image:Favorite card" content="">
	<meta name="text:Favorite card theme" content="Melt Down">
	<meta name="text:Favorite card member" content="SUNGJIN">
	<meta name="text:Playlist title" content="Currently listening to">
	<meta name="text:Playlist" content="[TRACK]&NewLine;NAME: Time of Our Life&NewLine;ARTIST: DAY6&NewLine;ICON: https://upload.wikimedia.org/wikipedia/en/5/5d/The_Book_of_Us_Gravity.jpg&NewLine;LINK: https://www.youtube.com/watch?v=vnS_jn2uibs&pp=ygUVdGltZSBvZiBvdXIgbGlmZSBkYXk2&NewLine;&NewLine;[TRACK]&NewLine;NAME: Love Parade&NewLine;ARTIST: DAY6 (Even of Day)&NewLine;ICON: https://upload.wikimedia.org/wikipedia/en/5/53/Even_of_Day_-_Right_Through_Me.png">
	<meta name="if:Show group blog members" content="0">
	<meta name="text:Group blog members title" content="Group members">

	<!-- Main content options -->
	<meta name="if:Search bar" content="1">
	<meta name="text:Search bar title" content="Search Blog">
	<meta name="if:Use legacy format for post media" content="0">
	<meta name="if:Post dates" content="1">
	<meta name="if:Post times" content="1">
	<meta name="if:Dates formatted month first" content="0">
	<meta name="if:24 hour times" content="0">
	<meta name="if:Like buttons" content="1">
	<meta name="if:Reblog buttons" content="1">
	<meta name="if:Day page links" content="1">
	<meta name="if:Post tags" content="1">
	<meta name="text:Filtered tags" content="spoiler, spoilers">

	<!-- Footer options -->
	<meta name="image:Default custom page icon" content="">
	<meta name="text:Custom page icons" content="LINK 1: https://64.media.tumblr.com/2e9fe957cf34cd1fa8ba293c8472ca06/92c1be194251d06c-e2/s2048x3072/1e9f63e6cc7fc1f4394aec09389880159bf20864.png&NewLine;LINK 2: https://64.media.tumblr.com/8e4dedbccb7adf157ce6a4e09aaa4530/92c1be194251d06c-a6/s128x128u_c1/09688375d285cd3b1837f3321234c4be939601cd.jpg">

	<!-- Other options -->
	<meta name="text:FAQ" content="This will go on your ask page, above your ask box.&NewLine;Add whatever HTML or plain text you want. If you don't want an FAQ, leave this field blank!">
	{/block:Hidden}

	<!-- Standardization of theme styles -->
	<link rel="stylesheet" href="https://wovenstarlight.github.io/tumblr-themes/normalize.min.css">

	<!-- Resource imports -->
	<!-- Phosphor Icons -->
	<script src="https://unpkg.com/@phosphor-icons/web@2.1.1"></script>
	<!-- SSRG-esque font -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+3">

	<!-- Theme styles -->
	<style>
		:root {
			font-size: {text:Font size};
			--bg-img: url('{image:Background}');
			--bg-position: {select:Background image focus};
			--profile-banner-position: {select:Profile banner image focus};
			--accent: {color:Accent};
		}
	</style>
	<!-- TODO: update this source link when publishing theme. -->
	<link rel="stylesheet" href="./theme.css">
	<style>{CustomCSS}</style>
</head>
<body>
	<a href="#main" id="skip" class="button-outline">Skip to main content</a>

	<!-- PAGE TITLE -->
	<h1 class="visuallyhidden">
		{block:AskPage}{AskLabel}{block:ShowTitle} | {/block:ShowTitle}{/block:AskPage}
		{block:SubmitPage}{SubmitLabel}{block:ShowTitle} | {/block:ShowTitle}{/block:SubmitPage}
		{block:TagPage}{lang:TagResultCount posts tagged Tag}{block:ShowTitle} | {/block:ShowTitle}{/block:TagPage}
		{block:SearchPage}{lang:SearchResultCount results for SearchQuery}{block:NoSearchResults}{lang:No results for SearchQuery}{/block:NoSearchResults}{block:ShowTitle} | {/block:ShowTitle}{/block:SearchPage}
		{block:PermalinkPage}{block:PostSummary}{PostSummary}{/block:PostSummary}{block:ShowTitle} | {/block:ShowTitle}{/block:PermalinkPage}
		{block:ShowTitle}{Title}{/block:ShowTitle}
	</h1>

	<header id="phead">
		<!-- USER BADGE: Name and title -->
		<button id="userbadge">
			<img src="{PortraitURL-128}" alt="User icon" class="avatar" />
			<div class="text">
				<p class="username">{Name}</p>
				<p class="{select:Weekly league} league">{Title}</p>
			</div>
		</button>

		<!-- USER PROFILE MODAL -->
		<dialog id="userprofile" class="modal" aria-labelledby="userprofiletitle">
			<header>
				<h2 id="userprofiletitle" class="modaltitle">{Name}'s INFORMATION</h2>
				<button class="closemodal">
					<span class="visuallyhidden">Close</span>
					<i class="ph ph-x" aria-hidden="true"></i>
				</button>
			</header>

			<dl id="about" class="profilesection">
				<div class="cards">
					<div id="profilename" class="card">
						<img src="{PortraitURL-128}" alt="User icon" class="avatar" />
						<dt class="visuallyhidden">Username</dt>
						<dd class="title">{Name}</dd>
						<dt class="visuallyhidden">Blog title</dt>
						<dd class="text {select:Weekly league}">{Title}</dd>
					</div>
					{block:IfStatusMessage}
					<div id="profilestatus" class="card">
						<dt class="title">Status message</dt>
						<dd class="text">{text:Status message}</dd>
					</div>
					{/block:IfStatusMessage}
					{block:IfFavoriteCardImage}
					<div id="profilefavcard" class="card">
						<dt class="title">Favorite card</dt>
						<dd class="text">
							{text:Favorite card theme}
							{block:IfFavoriteCardMember}<br />{text:Favorite card member}{/block:IfFavoriteCardMember}
						</dd>
						<img src="{image:Favorite card}" alt="{block:IfProfileFavoriteCardMember}{text:Favorite card member} {/block:IfProfileFavoriteCardMember}card from theme '{text:Favorite card theme}'">
					</div>
					{/block:IfFavoriteCardImage}
				</div>

				{block:IfProfileBannerImage}<img id="profilebanner" src="{image:Profile banner}" alt="Banner image">{/block:IfProfileBannerImage}

				{block:Description}{block:ShowDescription}
				<!-- BLOG DESCRIPTION -->
				<div id="desc">
					<dt class="title">Description</dt>
					<dd class="text">{Description}</dd>
				</div>
				{/block:ShowDescription}{/block:Description}
			</dl>

			{block:GroupMembers}{block:IfShowGroupBlogMembers}
			<!-- WEEKLY TOP 5: Blog members -->
			<section id="groupmembers" class="profilesection weeklytop5">
				<h3>{block:IfGroupBlogMembersTitle}{text:Group blog members title}{/block:IfGroupBlogMembersTitle}{block:IfNotGroupBlogMembersTitle}{lang:Group members}{/block:IfNotGroupBlogMembersTitle}</h3>
				<div class="contents">
					{block:GroupMember}
					<a href="{GroupMemberURL}">
						<figure>
							<img src="{GroupMemberPortraitURL-64}" alt="User icon" />
							<figcaption>
								<span class="name">{GroupMemberName}</span>
								<span class="score">{GroupMemberTitle}</span>
							</figcaption>
						</figure>
					</a>
					{/block:GroupMember}
				</div>
			</section>
			{/block:IfShowGroupBlogMembers}{/block:GroupMembers}

			{block:IfPlaylist}
			<!-- WEEKLY TOP 5: Playlist -->
			<section id="playlist" class="profilesection weeklytop5">
				<h3>{block:IfPlaylistTitle}{text:Playlist title}{/block:IfPlaylistTitle}{block:IfNotPlaylistTitle}Playlist{/block:IfNotPlaylistTitle}</h3>
				<div class="contents">{text:Playlist}</div>
			</section>
			{/block:IfPlaylist}

			<footer>
				<button class="button-solid-blue closemodal">OK</button>
			</footer>
		</dialog>

		<!-- RESOURCE COUNTERS: Navigation
		 Links are given the dropdown content item class to maintain styling when moved into the dropdown. -->
		<nav id="resourcenav" aria-label="Blog features" class="{block:AskEnabled}ask{/block:AskEnabled} {block:SubmissionsEnabled}submit{/block:SubmissionsEnabled} {block:IfRandomPostLink}random{/block:IfRandomPostLink} {block:IfArchiveLink}archive{/block:IfArchiveLink}">
			{block:AskEnabled}<a class="contentitem {block:AskPage}current-page{/block:AskPage}" href="/ask" id="ask">
				<i class="ph-thin ph-envelope" aria-hidden="true"></i>
				{AskLabel}
			</a>{/block:AskEnabled}
			{block:SubmissionsEnabled}<a class="contentitem {block:SubmitPage}current-page{/block:SubmitPage}" href="/submit" id="submit">
				<i class="ph-thin ph-tray" aria-hidden="true"></i>
				{SubmitLabel}
			</a>{/block:SubmissionsEnabled}
			{block:IfRandomPostLink}<a class="contentitem" href="/random" id="random">
				<i class="ph-thin ph-shuffle-angular" aria-hidden="true"></i>
				Random
			</a>{/block:IfRandomPostLink}
			{block:IfArchiveLink}<a class="contentitem" href="/archive" id="archive">
				<i class="ph-thin ph-calendar-check" aria-hidden="true"></i>
				Archive
			</a>{/block:IfArchiveLink}
		</nav>

		<!-- SETTINGS DROPDOWN: Blog info and theme credit -->
		<details id="moreinfo">
			<summary><span class="visuallyhidden">More information</span></summary>
			<div class="contents">
				<span class="contentitem">{Name} © {CopyrightYears}</span>
				<!-- DO NOT REMOVE CREDIT. LEAVE THIS INTACT. -->
				<a class="contentitem" href="https://starlightthemes.tumblr.com">Theme by starlightthemes</a>
				<!-- DO NOT REMOVE CREDIT. LEAVE THIS INTACT. -->
			</div>
		</details>
	</header>

	<main id="main">
		<header id="mainhead">
			{block:IfSearchBar}
			<!-- SEARCH BAR -->
			<button id="opensearch">Search</button>

			<dialog id="searchmodal" class="modal" aria-labelledby="searchtitle">
				<header>
					<h2 id="searchtitle" class="modaltitle">{block:IfSearchBarTitle}{text:Search bar title}{/block:IfSearchBarTitle}{block:IfNotSearchBarTitle}{lang:Search}{/block:IfNotSearchBarTitle}</h2>
					<button class="closemodal">
						<span class="visuallyhidden">Close</span>
						<i class="ph ph-x" aria-hidden="true"></i>
					</button>
				</header>

				<form action="/search" method="get" id="search">
					<label for="q" class="visuallyhidden">{block:IfSearchBarTitle}{text:Search bar title}{/block:IfSearchBarTitle}{block:IfNotSearchBarTitle}{lang:Search}{/block:IfNotSearchBarTitle}</label>
					<input id="q" type="search" name="q" value="{SearchQuery}" placeholder="Enter query here" required />
					<button type="submit" class="button-solid-blue">{lang:Search}</button>
				</form>
			</dialog>
			{/block:IfSearchBar}

			<!-- GRAY BADGE: Page title -->
			<h2 id="pagetitle">
				{block:HomePage}
				<!-- STANDARD PAGE HEADER -->
				<span class="label">{lang:Home}</span>
				{/block:HomePage}

				{block:AskPage}
				<!-- SPECIAL PAGE HEADER: ASK -->
				<span class="label">{AskLabel}</span>
				{/block:AskPage}
				{block:SubmitPage}
				<!-- SPECIAL PAGE HEADER: SUBMIT -->
				<span class="label">{SubmitLabel}</span>
				{/block:SubmitPage}

				{block:TagPage}
				<!-- SPECIAL PAGE HEADER: TAG -->
				<button class="label">{lang:TagResultCount posts tagged Tag 2}</button>
				{/block:TagPage}

				{block:DayPage}
				<!-- SPECIAL PAGE HEADER: DAY -->
				<span class="label">{lang:Viewing everything posted on Month DayOfMonth Year}</span>
				{/block:DayPage}

				{block:SearchPage}
				<!-- SPECIAL PAGE HEADER: SEARCH -->
				<span class="label">
					{lang:SearchResultCount results for SearchQuery 2}
					{block:NoSearchResults}{lang:No results for SearchQuery 2}{/block:NoSearchResults}
				</span>
				{/block:SearchPage}

				{block:PermalinkPage}
				<!-- SPECIAL PAGE HEADER: PERMALINK -->
				<span class="label">
					{lang:Permalink}
				</span>
				{/block:PermalinkPage}
			</h2>

			{block:TagPage}
			<dialog id="tagordering" class="modal">
				<header>
					<h2 id="searchtitle" class="modaltitle">{block:IfSearchBarTitle}{text:Search bar title}{/block:IfSearchBarTitle}{block:IfNotSearchBarTitle}{lang:Search}{/block:IfNotSearchBarTitle}</h2>
					<button class="closemodal">
						<span class="visuallyhidden">Close</span>
						<i class="ph ph-x" aria-hidden="true"></i>
					</button>
				</header>

				<p class="orderlinks">
					<a class="button-solid-gray" href="/tagged/{URLSafeTag}">Newest first</a>
					<a class="button-solid-gray" href="/tagged/{URLSafeTag}/chrono">Oldest first</a>
				</p>
			</dialog>
			{/block:TagPage}
		</header>

		<!-- SONG SCROLLER: Posts -->
		<section id="posts">
			<noscript><article id="noscriptnotice">Javascript is required to view this blog. Please enable scripting and reload.</article></noscript>

			<!-- JUMP TO START -->
			<button id="scrolltostart" disabled>
				<span class="visuallyhidden">{lang:Back to top}</span>
				<i class="ph-thin ph-caret-left" aria-hidden="true"></i><i class="ph-thin ph-caret-left" aria-hidden="true"></i>
			</button>
		</section>
	</main>

	<footer id="pfoot">
		<!-- SCORE CHALLENGE & RECORDS: Pagination -->
		<nav id="pagination" aria-label="Page navigation">
			<p class="text">
				<span class="title">{lang:Navigate}</span>
				{block:IndexPage}<span class="index pagecount">{lang:CurrentPage of TotalPages}</span>{/block:IndexPage}
				{block:PermalinkPage}<span class="permalink pagecount">{lang:See more posts}</span>{/block:PermalinkPage}
				{block:DayPage}{block:DayPagination}<span class="day pagecount">{block:IfDatesFormattedMonthFirst}{Month} {DayOfMonth},{/block:IfDatesFormattedMonthFirst}{block:IfNotDatesFormattedMonthFirst}{DayOfMonth} {Month}{/block:IfNotDatesFormattedMonthFirst} {Year}</span>{/block:DayPagination}{/block:DayPage}
			</p>
			<div class="pagelinks">
				<a
					{block:Pagination}{block:PreviousPage}href="{PreviousPage}"{/block:PreviousPage}{/block:Pagination}
					{block:PermalinkPagination}{block:PreviousPost}href="{PreviousPost}"{/block:PreviousPost}{/block:PermalinkPagination}
					{block:DayPage}{block:DayPagination}{block:PreviousDayPage}href="{PreviousDayPage}"{/block:PreviousDayPage}{/block:DayPagination}{/block:DayPage}
					id="prev" class="button-solid-blue"
				>
					{block:IndexPage}<span class="index">{lang:Previous page}</span>{/block:IndexPage}
					{block:PermalinkPage}<span class="permalink">{lang:Previous post}</span>{/block:PermalinkPage}
					{block:DayPage}<span class="day">{lang:Previous day}</span>{/block:DayPage}
				</a>
				<a
					{block:Pagination}{block:NextPage}href="{NextPage}"{/block:NextPage}{/block:Pagination}
					{block:PermalinkPagination}{block:NextPost}href="{NextPost}"{/block:NextPost}{/block:PermalinkPagination}
					{block:DayPage}{block:DayPagination}{block:NextDayPage}href="{NextDayPage}"{/block:NextDayPage}{/block:DayPagination}{/block:DayPage}
					id="next" class="button-solid-blue"
				>
					{block:IndexPage}<span class="index">{lang:Next page}</span>{/block:IndexPage}
					{block:PermalinkPage}<span class="permalink">{lang:Next post}</span>{/block:PermalinkPage}
					{block:DayPage}<span class="day">{lang:Next day}</span>{/block:DayPage}
				</a>
			</div>
		</nav>

		{block:HasPages}
		<!-- EQUIPPED CARDS: Custom pages -->
		<nav id="pages" aria-label="Blog pages">
			<span id="custompageicons" class="visuallyhidden">{text:Custom page icons}</span>
			{block:Pages}<a href="{URL}" class="{CurrentState}">
				<span class="visuallyhidden">{Label}</span>
				{block:IfDefaultCustomPageIconImage}<img src="{image:Default custom page icon}" alt="" aria-hidden="true" title="{PlaintextLabel}" />{/block:IfDefaultCustomPageIconImage}{block:IfNotDefaultCustomPageIconImage}<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="140" viewBox="0 0 100 140" aria-hidden="true" title="{PlaintextLabel}"><rect x="0" y="0" width="100" height="140" rx="6" fill="#000000" /><g transform="matrix(3.9 0 0 3.9 49.61 69.61)"><path fill="#f2f3f3" transform=" translate(-8.5, -8.5)" d="M 9.9 5.1 c -0.2 0.3 -0.5 1.4 -0.6 2.6 l 1.1 -0.1 c 0.7 -0.1 1.3 -0.3 1.5 -0.5 c 0.6 -0.6 0.6 -1.4 0 -2 c -0.6 -0.5 -1.4 -0.5 -2 0 z M 8.5 0 C 3.8 0 0 3.8 0 8.5 S 3.8 17 8.5 17 S 17 13.2 17 8.5 S 13.2 0 8.5 0 z m 4.4 8.2 c -0.5 0.5 -1.5 0.8 -2.5 0.9 l -1.2 0.2 c -0.1 1.3 -0.4 2.9 -1 3.6 c -1.1 1.1 -3 1.2 -4.1 0 c -1.1 -1.1 -1.1 -3 0 -4.1 c 0.5 -0.5 1.5 -0.8 2.6 -0.9 v 1.5 c -1.2 0.3 -1.5 0.5 -1.6 0.5 c -0.6 0.6 -0.6 1.4 0 2 c 0.5 0.5 1.4 0.5 2 0 c 0.2 -0.2 0.5 -1.1 0.6 -2.5 l 0.1 -0.9 c 0 -1.3 0.2 -3.6 1 -4.4 c 1.1 -1.1 3 -1.2 4.1 0 c 1.2 1.1 1.2 2.9 0 4.1 z" /></g></svg>{/block:IfNotDefaultCustomPageIconImage}
			</a>{/block:Pages}
		</nav>
		{/block:HasPages}

		<!-- START: Home -->
		<nav id="footright" aria-label="Home page">
			<p class="text">
				<svg fill="currentColor" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M256,0C114.615,0,0,114.615,0,256S114.615,512,256,512,512,397.385,512,256,397.385,0,256,0Zm42.535,401.327c-23.477,4.4-103.885,2.934-103.885-85.1V228.185H164.717V190.822a85.4,85.4,0,0,0,13.123-6.657,104.632,104.632,0,0,0,16.81-12.595c13.98-12.9,27.585-32.973,27.585-62.237h45.592v74.832h58.586v44.02H267.827v88.038c0,24.451,9.966,41.284,51.637,27.586l14.485,42.058S322.012,396.924,298.535,401.327Z"/></svg>
				<span class="label">{lang:Powered by Tumblr}</span>
			</p>
			<a id="home" href="/" class="button-solid-blue">{lang:Home}</a>
		</nav>
	</footer>

<!-- The actual functionality of the theme. -->
<script>
/**
 * The standard page font size, for calculating padding.
 * @type {number}
 */
const em = parseFloat(getComputedStyle(document.documentElement).fontSize);

// #region Top navigation placement calculator
/** The top navigation bar visible by default. */
const topNav = document.getElementById("resourcenav");
// Check that anything actually needs calculating
if (topNav.childElementCount > 0) {
	/** The minimal width of the user badge on the left displaying the user's name and title. */
	const userBadgeMinimumWidth = Array.from(document.getElementById("userbadge").children)
			.map(el => el.offsetWidth).reduce((a, b) => a + b, 0)	// Width of content
			+ 0.6 * em												// Spacing between icon and text
			+ (1.3 * em * 2);										// Inline padding of userbadge itself
	/** The links in the top navigation bar. Will always contain at least the "Home" link. */
	const topNavChildren = Array.from(topNav.children);
	/** The minimal width of the top navigation bar. */
	const topMinimumWidth = topNavChildren.map(el => el.offsetWidth).reduce((a, b) => a + b, 0)
			+ (0.6 * (1.2 * em) * (topNavChildren.length - 1))		// Spacing between links
			+ (2.5 * em);											// Inline padding of topnav itself, plus a little extra for breathing room
	/** The dropdown navigation's toggle, for assisting in the top nav's placement. */
	const dropdownNavToggle = document.getElementById("moreinfo").firstElementChild;
	/** The dropdown navigation's contents, for containing the collapsed top nav's children. */
	const dropdownNavContents = document.getElementById("moreinfo").lastElementChild;
	/** The dropdown navigation's first item, for reference when moving links. */
	const dropdownNavTopItem = dropdownNavContents.firstElementChild;

	/** Moves the links in the top nav (home, etc.) to the dropdown if the page size is too small to fit all the links on one line. */
	function moveTopNav() {
		let topNavAvailableSpace = dropdownNavToggle.offsetLeft - userBadgeMinimumWidth;

		if (topNavAvailableSpace < topMinimumWidth && topNav.childElementCount !== 0) {
			topNavChildren.forEach(el => {
				dropdownNavContents.insertBefore(el, dropdownNavTopItem);
			})
			topNav.classList.add("empty");
		} else if (topNavAvailableSpace > topMinimumWidth && topNav.childElementCount === 0) {
			topNav.classList.remove("empty");
			topNavChildren.forEach(el => {
				topNav.append(el);
			})
		}
	}

	// Reassess top nav's ideal placement on window resize.
	window.addEventListener("resize", () => { moveTopNav() });
	// Check top nav's ideal placement upon initial page load.
	moveTopNav();
}

document.addEventListener("click", e => {
	const moreinfo = document.getElementById("moreinfo");
	if (moreinfo.getAttribute("open") !== null && e.target.closest("#moreinfo") == null) {
		moreinfo.removeAttribute("open");
	}
})
// #endregion

// #region Modals open/close functionality
// Open: User profile
document.getElementById("userbadge").addEventListener("click", () => { document.getElementById("userprofile").showModal() });
document.getElementById("opensearch").addEventListener("click", () => { document.getElementById("searchmodal").showModal() });
{block:TagPage}
document.querySelector("#pagetitle button").addEventListener("click", () => { document.getElementById("tagordering").showModal() });
{/block:TagPage}
// Close
document.querySelectorAll(".modal").forEach(modal => {
	// On button click
	modal.querySelectorAll(".modal .closemodal").forEach(btn => btn.addEventListener("click", () => { modal.close() }));

	// On ::backdrop click
	modal.addEventListener('mousedown', e => {
		e.currentTarget._offsetX = e.offsetX;
		e.currentTarget._offsetY = e.offsetY;
	});
	modal.addEventListener('click', e => {
		if ((
			e.currentTarget._offsetX < 0 || e.currentTarget._offsetX > e.target.offsetWidth ||
			e.currentTarget._offsetY < 0 || e.currentTarget._offsetY > e.target.offsetHeight
		) && (
			e.offsetX < 0 || e.offsetX > e.target.offsetWidth ||
			e.offsetY < 0 || e.offsetY > e.target.offsetHeight
		)) {
			modal.close();
		}
	});
});
// #endregion

// #region Search form
function enableSearch(e) {
	if (e.currentTarget.value !== "") {
		e.currentTarget.nextElementSibling.removeAttribute("disabled");
	}
	else {
		e.currentTarget.nextElementSibling.setAttribute("disabled", "true");
	}
}
document.getElementById("q").addEventListener("input", enableSearch);
enableSearch({ currentTarget: document.getElementById("q") });
// #endregion

// #region Playlist
let playlist = document.querySelector("#playlist .contents");
if (playlist !== null) {
	let playlistTracks = playlist.innerHTML.split("[TRACK]")
		.filter(el => el !== "")
		.map(el => {
			let arr = el.trim().split(String.fromCharCode(10)),
				obj = {};
			arr.forEach(line => {
				parts = line.trim().split(":");
				obj[parts[0].trim()] = parts.slice(1).join(":").trim();
			});
			return obj;
		})
		.map(el => {
			// Create and assemble HTML element
			let track = document.createElement("a"),
				trackInner = document.createElement("figure"),
				trackImage = document.createElement(el.ICON != null ? "img" : "svg"),
				trackText = document.createElement("figcaption"),
				trackName = document.createElement("span"),
				trackArtist = document.createElement("span");
			track.append(trackInner);
			trackInner.append(trackImage, trackText);
			trackImage.alt = "";	// Mark as decorative
			trackName.classList.add("name");
			trackArtist.classList.add("score");
			// Start adding information
			if (el.LINK != null) track.href = el.LINK;
			if (el.ICON != null) { trackImage.src = el.ICON }
			else {
				trackImage.setAttribute("xmlns", "http://www.w3.org/2000/svg");
				trackImage.setAttribute("version", "1.1");
				trackImage.setAttribute("width", "108");
				trackImage.setAttribute("height", "108");
				trackImage.setAttribute("viewbox", "0 0 108 108");
				trackImage.innerHTML = '<rect width="24" height="4" x="42" y="52" fill="currentColor" />';
			}
			if (el.NAME != null) {
				trackName.innerHTML = el.NAME;
				trackText.append(trackName);
			}
			if (el.ARTIST != null) {
				trackArtist.innerHTML = el.ARTIST;
				trackText.append(trackArtist);
			}
			return el.NAME == null && el.ARTIST == null ? null : track;
		});
	playlist.textContent = "";
	playlistTracks.filter(el => el !== null).forEach(el => playlist.append(el));
}
// #endregion

{block:TagPage}
// #region Tag page current selection
document.querySelectorAll("#tagordering .orderlinks a")[window.location.href.split("/").slice(5)[0] === "chrono" ? 1 : 0].classList.replace("button-solid-gray", "button-solid-blue");
// #endregion
{/block:TagPage}

{block:IfCustomPageIcons}{block:HasPages}
// #region Custom page icon assignment
const customPageLinks = document.querySelectorAll("#pages a");
const customPageIcons = document.getElementById("custompageicons").innerHTML
	.split(/LINK \d+:/i, customPageLinks.length + 1)	// get as many icons as pages (+1 because [0] will be empty string)
	.slice(1)	// omit the empty string at the start
	.map(el => el.trim());	// trim whitespace so they're fit for SRCing
customPageLinks.forEach((el, index) => {
	if (customPageIcons[index] != null && customPageIcons[index] !== "") {
		// Icon provided, use it for display

		let img = document.createElement("img");
		img.src = unescapeHTML(customPageIcons[index]);
		img.alt = "";	// mark as decorative
		img.setAttribute("aria-hidden", "true");	// hide img
		img.setAttribute("title", el.lastElementChild.getAttribute("title"));
		img.addEventListener("load", () => {
			el.setAttribute("style", `--max-card-width: ${img.offsetWidth / em}em;`);
		});
		el.lastElementChild.remove();	// get rid of the SVG…
		el.append(img);	// …and replace it with the IMG
	}
});
// #endregion
{/block:HasPages}{/block:IfCustomPageIcons}

// #region Scroll to start
(scrollToStart = document.getElementById("scrolltostart")).addEventListener("click", () => {
	postContainer.scrollTo({
		left: 0,
		behavior: "smooth",
	});
});
postContainer.addEventListener("scroll", () => {
	if (postContainer.scrollLeft <= 200) {
		scrollToStart.setAttribute("disabled", "true");
	}
	else {
		scrollToStart.removeAttribute("disabled");
	}
})
// #endregion
</script>

</body>
</html>