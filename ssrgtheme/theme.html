<!--
	THEME 14: RHYTHMIC by starlightthemes

	Credits:
		Phosphor Icons: https://phosphoricons.com/

	Last updated 16 Oct 2024.
-->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>{Title}{block:TagPage} ({lang:TagResultCount posts tagged Tag}){/block:TagPage}{block:SearchPage} ({lang:SearchResultCount results for SearchQuery}{block:NoSearchResults}{lang:No results for SearchQuery}{/block:NoSearchResults}){/block:SearchPage}{block:PermalinkPage}{block:PostSummary} — {PostSummary}{/block:PostSummary}{/block:PermalinkPage}</title>
	<meta name="description" content="{MetaDescription}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="shortcut icon" href="{Favicon}">
	<link rel="apple-touch-icon-precomposed" href="{PortraitURL-128}">
	<link rel="alternate" type="application/rss+xml" href="{RSS}">

	<!-- Commented out for local development. TODO: Uncomment this for publishing.
	{block:Hidden} -->
	<!-- THEME VARIABLES -->
	<!-- Text and coloration -->
	<meta name="text:Font size" content="16px">
	<meta name="color:Profile accent" content="#481f19">

	<!-- Title coloration display option -->
	<meta name="select:Weekly league" content="" title="League unregistered">
	<meta name="select:Weekly league" content="bronze" title="Bronze">
	<meta name="select:Weekly league" content="silver" title="Silver">
	<meta name="select:Weekly league" content="gold" title="Gold">
	<meta name="select:Weekly league" content="platinum" title="Platinum">
	<meta name="select:Weekly league" content="master" title="Master">

	<!-- Image options -->
	<meta name="image:Background" content="{HeaderImage}">
	<meta name="select:Background image focus" content="center" title="Center">
	<meta name="select:Background image focus" content="top" title="Top">
	<meta name="select:Background image focus" content="bottom" title="Bottom">
	<meta name="image:Profile banner" content="{HeaderImage}">
	<meta name="select:Profile banner image focus" content="center" title="Center">
	<meta name="select:Profile banner image focus" content="top" title="Top">
	<meta name="select:Profile banner image focus" content="bottom" title="Bottom">

	<!-- General theme options -->
	<meta name="if:Random post link" content="1">
	<meta name="if:Archive link" content="1">
	<meta name="text:Profile status message" content="Say what you want!">
	<meta name="image:Profile favorite card" content="">
	<meta name="text:Profile favorite card theme" content="Melt Down">
	<meta name="text:Profile favorite card member" content="SUNGJIN">
	<meta name="text:Playlist title" content="Currently listening to">
	<meta name="text:Playlist" content="[TRACK]&NewLine;NAME: Time of Our Life&NewLine;ARTIST: DAY6&NewLine;ICON: https://upload.wikimedia.org/wikipedia/en/5/5d/The_Book_of_Us_Gravity.jpg&NewLine;LINK: https://www.youtube.com/watch?v=vnS_jn2uibs&pp=ygUVdGltZSBvZiBvdXIgbGlmZSBkYXk2&NewLine;&NewLine;[TRACK]&NewLine;NAME: Love Parade&NewLine;ARTIST: DAY6 (Even of Day)&NewLine;ICON: https://upload.wikimedia.org/wikipedia/en/5/53/Even_of_Day_-_Right_Through_Me.png">
	<meta name="if:Show group blog members" content="0">
	<meta name="text:Group blog members title" content="Group members">
	<!-- TODO: Decide which of these can be used for this theme.
	<meta name="text:Filtered tags" content="spoiler, spoilers">
	<meta name="if:Back to top button" content="1">
	<meta name="if:Search bar" content="1">
	<meta name="text:Search bar title" content="Search">
	<meta name="if:Post dates" content="1">
	<meta name="if:Post times" content="1">
	<meta name="if:Dates formatted month first" content="0">
	<meta name="if:24 hour times" content="0">
	<meta name="if:Like buttons" content="1">
	<meta name="if:Reblog buttons" content="1">
	<meta name="if:Post tags" content="1">
	<meta name="if:Show tags on click" content="0">
	<meta name="text:Custom links title" content="Navigate">
	<meta name="text:FAQ" content="This will go on your ask page, above your ask box.&NewLine;Add whatever HTML or plain text you want. If you don't want an FAQ, leave this field blank!">
	-->
	<!-- {/block:Hidden} -->

	<!-- Standardization of theme styles -->
	<link rel="stylesheet" href="https://wovenstarlight.github.io/tumblr-themes/normalize.min.css">

	<!-- Resource import: SSRG-esque font -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+3">

	<!-- Theme styles -->
	<style>
		:root {
			--bg-img: url('{image:Background}');
			--bg-position: {select:Background image focus};
			--profile-banner-position: {select:Profile banner image focus};
			--profile-accent: {color:Profile accent};
		}
	</style>
	<!-- TODO: update this source link when publishing theme. -->
	<link rel="stylesheet" href="./theme.css">
	<style>{CustomCSS}</style>
</head>
<body>
	<a href="#main" id="skip" class="button-outline">Skip to main content</a>

	<header id="phead">
		<!-- USER BADGE: Name and title -->
		<button id="userbadge">
			<img src="{PortraitURL-128}" alt="User icon" class="avatar" />
			<hgroup>
				<h1>{Name}</h1>
				<p class="{select:Weekly league}">{Title}</p>
			</hgroup>
		</button>

		<!-- USER PROFILE MODAL -->
		<dialog id="userprofile">
			<header>
				<h2>{Name}'s INFORMATION</h2>
				<button class="closeprofile">
					<span class="visuallyhidden">Close</span>
					<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256" aria-hidden="true"><path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path></svg>
				</button>
			</header>

			<dl id="about" class="profilesection">
				<div class="cards">
					<div id="profilename" class="card">
						<img src="{PortraitURL-128}" alt="User icon" class="avatar" />
						<dt class="visuallyhidden">Username</dt>
						<dd class="title">{Name}</dd>
						<dt class="visuallyhidden">Blog title</dt>
						<dd class="text {select:Weekly league}">{Title}</dd>
					</div>
					{block:IfProfileStatusMessage}
					<div id="profilestatus" class="card">
						<dt class="title">Status message</dt>
						<dd class="text">{text:Profile status message}</dd>
					</div>
					{/block:IfProfileStatusMessage}
					{block:IfProfileFavoriteCardImage}
					<div id="profilefavcard" class="card">
						<dt class="title">Favorite card</dt>
						<dd class="text">
							{text:Profile favorite card theme}
							{block:IfProfileFavoriteCardMember}<br />{text:Profile favorite card member}{/block:IfProfileFavoriteCardMember}
						</dd>
						<img src="{image:Profile favorite card}" alt="{block:IfProfileFavoriteCardMember}{text:Profile favorite card member} {/block:IfProfileFavoriteCardMember}card from theme '{text:Profile favorite card theme}'">
					</div>
					{/block:IfProfileFavoriteCardImage}
				</div>

				{block:IfProfileBannerImage}<img id="profilebanner" src="{image:Profile banner}" alt="Banner image">{/block:IfProfileBannerImage}

				{block:Description}{block:ShowDescription}
				<!-- BLOG DESCRIPTION -->
				<div id="desc">
					<dt class="title">Description</dt>
					<dd class="text">{Description}</dd>
				</div>
				{/block:ShowDescription}{/block:Description}
			</dl>

			{block:GroupMembers}{block:IfShowGroupBlogMembers}
			<!-- WEEKLY TOP 5: Blog members -->
			<section id="groupmembers" class="profilesection weeklytop5">
				<h3>{block:IfGroupBlogMembersTitle}{text:Group blog members title}{/block:IfGroupBlogMembersTitle}{block:IfNotGroupBlogMembersTitle}{lang:Group members}{/block:IfNotGroupBlogMembersTitle}</h3>
				<div class="contents">
					{block:GroupMember}
					<a href="{GroupMemberURL}">
						<figure>
							<!-- <img src="{GroupMemberPortraitURL-64}" alt="User icon" /> -->
							<img src="{GroupMemberPortraitURL-64}" />
							<figcaption>
								<span class="name">{GroupMemberName}</span>
								<span class="score">{GroupMemberTitle}</span>
							</figcaption>
						</figure>
					</a>
					{/block:GroupMember}
				</div>
			</section>
			{/block:IfShowGroupBlogMembers}{/block:GroupMembers}

			{block:IfPlaylist}
			<!-- WEEKLY TOP 5: Playlist -->
			<section id="playlist" class="profilesection weeklytop5">
				<h3>{block:IfPlaylistTitle}{text:Playlist title}{/block:IfPlaylistTitle}{block:IfNotPlaylistTitle}Playlist{/block:IfNotPlaylistTitle}</h3>
				<div class="contents">{text:Playlist}</div>
			</section>
			{/block:IfPlaylist}

			<footer>
				<button class="button-solid closeprofile">OK</button>
			</footer>
		</dialog>

		<!-- RESOURCE COUNTERS: Navigation
		 Links are given the dropdown content item class to maintain styling when moved into the dropdown. -->
		<nav id="resourcenav">
			<a class="contentitem" href="/" id="home">
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" aria-hidden="true" viewBox="0 0 256 256"><path d="M216.49,111.51l-80-80a12,12,0,0,0-17,0l-80,80A12,12,0,0,0,36,120v96a4,4,0,0,0,4,4h64a4,4,0,0,0,4-4V156h40v60a4,4,0,0,0,4,4h64a4,4,0,0,0,4-4V120A12,12,0,0,0,216.49,111.51ZM212,212H156V152a4,4,0,0,0-4-4H104a4,4,0,0,0-4,4v60H44V120a4,4,0,0,1,1.17-2.83l80-80a4,4,0,0,1,5.66,0l80,80A4,4,0,0,1,212,120Z"></path></svg>
				Home
			</a>
			{block:AskEnabled}<a class="contentitem" href="/ask" id="ask">
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" aria-hidden="true" viewBox="0 0 256 256"><path d="M224,52H32a4,4,0,0,0-4,4V192a12,12,0,0,0,12,12H216a12,12,0,0,0,12-12V56A4,4,0,0,0,224,52Zm-96,86.57L42.28,60H213.72ZM104.63,128,36,190.91V65.09Zm5.92,5.43L125.3,147a4,4,0,0,0,5.4,0l14.75-13.52L213.72,196H42.28ZM151.37,128,220,65.09V190.91Z"></path></svg>
				Message
			</a>{/block:AskEnabled}
			{block:SubmissionsEnabled}<a class="contentitem" href="/submit" id="submit">
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" aria-hidden="true" viewBox="0 0 256 256"><path d="M208,36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36ZM48,44H208a4,4,0,0,1,4,4V156H179.31a12,12,0,0,0-8.48,3.51l-19.32,19.32a4,4,0,0,1-2.82,1.17H107.31a4,4,0,0,1-2.82-1.17L85.17,159.51A12,12,0,0,0,76.69,156H44V48A4,4,0,0,1,48,44ZM208,212H48a4,4,0,0,1-4-4V164H76.69a4,4,0,0,1,2.82,1.17l19.32,19.32a12,12,0,0,0,8.48,3.51h41.38a12,12,0,0,0,8.48-3.51l19.32-19.32a4,4,0,0,1,2.82-1.17H212v44A4,4,0,0,1,208,212Z"></path></svg>
				Submit
			</a>{/block:SubmissionsEnabled}
			{block:IfRandomPostLink}<a class="contentitem" href="/random" id="random">
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" aria-hidden="true" viewBox="0 0 256 256"><path d="M234.83,181.17a4,4,0,0,1,0,5.66l-24,24a4,4,0,0,1-5.66-5.66L222.34,188H168a4,4,0,0,1-3.25-1.67L85.94,76H32a4,4,0,0,1,0-8H88a4,4,0,0,1,3.25,1.67L170.06,180h52.28l-17.17-17.17a4,4,0,0,1,5.66-5.66Zm-89.49-77.44a4,4,0,0,0,5.58-.93L170.06,76h52.28L205.17,93.17a4,4,0,0,0,5.66,5.66l24-24a4,4,0,0,0,0-5.66l-24-24a4,4,0,0,0-5.66,5.66L222.34,68H168a4,4,0,0,0-3.25,1.67L144.41,98.15A4,4,0,0,0,145.34,103.73Zm-34.68,48.54a4,4,0,0,0-5.58.93L85.94,180H32a4,4,0,0,0,0,8H88a4,4,0,0,0,3.25-1.67l20.34-28.48A4,4,0,0,0,110.66,152.27Z"></path></svg>
				Random
			</a>{/block:IfRandomPostLink}
			{block:IfArchiveLink}<a class="contentitem" href="/archive" id="archive">
				<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" aria-hidden="true" viewBox="0 0 256 256"><path d="M208,36H180V24a4,4,0,0,0-8,0V36H84V24a4,4,0,0,0-8,0V36H48A12,12,0,0,0,36,48V208a12,12,0,0,0,12,12H208a12,12,0,0,0,12-12V48A12,12,0,0,0,208,36ZM48,44H76V56a4,4,0,0,0,8,0V44h88V56a4,4,0,0,0,8,0V44h28a4,4,0,0,1,4,4V84H44V48A4,4,0,0,1,48,44ZM208,212H48a4,4,0,0,1-4-4V92H212V208A4,4,0,0,1,208,212Zm-41.17-86.83a4,4,0,0,1,0,5.66l-48,48a4,4,0,0,1-5.66,0l-24-24a4,4,0,0,1,5.66-5.66L116,170.34l45.17-45.17A4,4,0,0,1,166.83,125.17Z"></path></svg>
				Archive
			</a>{/block:IfArchiveLink}
		</nav>

		<!-- SETTINGS DROPDOWN: Blog info and theme credit -->
		<details id="moreinfo">
			<summary><span class="visuallyhidden">More information</span></summary>
			<div class="contents">
				<span class="contentitem">{Name} © {CopyrightYears}</span>
				<!-- DO NOT REMOVE CREDIT. LEAVE THIS INTACT. -->
				<a class="contentitem" href="https://starlightthemes.tumblr.com">Theme by starlightthemes</a>
				<!-- DO NOT REMOVE CREDIT. LEAVE THIS INTACT. -->
			</div>
		</details>
	</header>

	<main id="main">
		<!-- TODO: main content goes here -->
	</main>
	
	<footer id="pfoot">
		<!-- TODO: footer goes here -->
	</footer>

	<!-- For local development only. TODO: Remove on completion. -->
	<script>
		document.title = "SSRG Theme";
		document.querySelectorAll("img[alt='User icon']").forEach(el => el.setAttribute("src", "./ref-assets/avatar.png"));
		document.querySelector("#userbadge h1").innerText = "bbybread28";
		document.querySelector("#userbadge p").innerText = "Master III";
		document.querySelector("#userbadge p").setAttribute("class", "master");
		document.getElementById("home").setAttribute("href", "./theme.html");
		document.body.setAttribute("style", "--bg-img: url('./ref-assets/bg2.png'); --bg-position: center;--profile-banner-position: center; --profile-accent: #1f3853;");
		document.querySelectorAll("#resourcenav").forEach(el => {
			el.innerHTML = el.innerHTML.replace(/\{\/?\w+(:\w+)?\}/g, "");
		})
		const userProfileModal = document.getElementById("userprofile");
		userProfileModal.showModal();
		userProfileModal.querySelector("h2").innerText = "bbybread28's INFORMATION";
		userProfileModal.querySelector("img[alt='User icon']").setAttribute("src", "./ref-assets/avatar.png");
		userProfileModal.querySelector("#profilename .title").innerText = "bbybread28";
		userProfileModal.querySelector("#profilename .text").innerText = "Master III";
		userProfileModal.querySelector("#profilename .text").setAttribute("class", "text master");
		userProfileModal.querySelector("#profilestatus .text").innerText = "걷잡을 수 없이 스르륵 녹아내려요";
		userProfileModal.querySelector("#profilefavcard .text").innerHTML = "Melt Down<br />SUNGJIN";
		userProfileModal.querySelector("#profilefavcard img").setAttribute("src", "./ref-assets/favcard.png");
		userProfileModal.querySelector("#profilebanner").setAttribute("src", "./ref-assets/bg2.png");
		userProfileModal.querySelector("#desc .text").innerHTML = "<p>Description will go here in the future</p><p>Test</p><p>Test</p>";
		userProfileModal.querySelector("#groupmembers h3").innerText = "Group members";
		userProfileModal.querySelectorAll("#groupmembers img").forEach(el => el.setAttribute("src", "https://api.tumblr.com/v2/blog/wovenstarlight.tumblr.com/avatar"));
		userProfileModal.querySelector("#groupmembers .name").innerText = "wovenstarlight";
		userProfileModal.querySelector("#groupmembers .score").innerText = "no one i love like that old bitch elder";
		userProfileModal.innerHTML = userProfileModal.innerHTML.replace(/\{\/?\w+(:\w+)?\}/g, "");
		userProfileModal.scrollBy(0, userProfileModal.offsetHeight);
		userProfileModal.close();
	</script>

<!-- The actual functionality of the theme. -->
<script>
// #region Top navigation placement calculator
/** The standard page font size, for calculating padding. */
const em = parseFloat(getComputedStyle(document.documentElement).fontSize);
/** The minimal width of the user badge on the left displaying the user's name and title. */
const userBadgeMinimumWidth = Array.from(document.getElementById("userbadge").children)
		.map(el => el.offsetWidth).reduce((a, b) => a + b, 0)	// Width of content
		+ 0.6 * em												// Spacing between icon and text
		+ (1.3 * em * 2);										// Inline padding of userbadge itself
/** The top navigation bar visible by default. */
const topNav = document.getElementById("resourcenav");
/** The links in the top navigation bar. Will always contain at least the "Home" link. */
const topNavChildren = Array.from(topNav.children);
/** The minimal width of the top navigation bar. */
const topMinimumWidth = topNavChildren.map(el => el.offsetWidth).reduce((a, b) => a + b, 0)
		+ (0.6 * (1.2 * em) * (topNavChildren.length - 1))		// Spacing between links
		+ (2.5 * em);											// Inline padding of topnav itself, plus a little extra for breathing room
/** The dropdown navigation's toggle, for assisting in the top nav's placement. */
const dropdownNavToggle = document.getElementById("moreinfo").firstElementChild;
/** The dropdown navigation's contents, for containing the collapsed top nav's children. */
const dropdownNavContents = document.getElementById("moreinfo").lastElementChild;
/** The dropdown navigation's first item, for reference when moving links. */
const dropdownNavTopItem = dropdownNavContents.firstElementChild;

/** Moves the links in the top nav (home, etc.) to the dropdown if the page size is too small to fit all the links on one line. */
function moveTopNav() {
	let topNavAvailableSpace = dropdownNavToggle.offsetLeft - userBadgeMinimumWidth;

	if (topNavAvailableSpace < topMinimumWidth && topNav.childElementCount !== 0) {
		topNavChildren.forEach(el => {
			dropdownNavContents.insertBefore(el, dropdownNavTopItem);
		})
		topNav.classList.add("empty");
	} else if (topNavAvailableSpace > topMinimumWidth && topNav.childElementCount === 0) {
		topNav.classList.remove("empty");
		topNavChildren.forEach(el => {
			topNav.append(el);
		})
	}
}

// Reassess top nav's ideal placement on window resize.
window.addEventListener("resize", () => { moveTopNav() });
// Check top nav's ideal placement upon initial page load.
moveTopNav();

document.addEventListener("click", e => {
	const moreinfo = document.getElementById("moreinfo");
	if (moreinfo.getAttribute("open") !== null && e.target.closest("#moreinfo") == null) {
		moreinfo.removeAttribute("open");
	}
})
// #endregion

// #region Profile modal functionality
// Open/close
const userProfile = document.getElementById("userprofile");
document.getElementById("userbadge").addEventListener("click", () => { userProfile.showModal() });
userProfile.querySelectorAll(".closeprofile").forEach(el => el.addEventListener("click", () => { userProfile.close() }));

// Playlist
let playlist = document.querySelector("#playlist .contents");
if (playlist !== null) {
	let playlistTracks = playlist.innerHTML.split("[TRACK]")
		.filter(el => el !== "")
		.map(el => {
			let arr = el.trim().split(String.fromCharCode(10)),
				obj = {};
			arr.forEach(line => {
				parts = line.trim().split(":");
				obj[parts[0].trim()] = parts.slice(1).join(":").trim();
			});
			return obj;
		})
		.map(el => {
			// Create and assemble HTML element
			let track = document.createElement("a"),
				trackInner = document.createElement("figure"),
				trackImage = document.createElement("img"),
				trackText = document.createElement("figcaption"),
				trackName = document.createElement("span"),
				trackArtist = document.createElement("span");
			track.append(trackInner);
			trackInner.append(trackImage, trackText);
			trackImage.alt = "";	// Mark as decorative
			trackName.classList.add("name");
			trackArtist.classList.add("score");
			// Start adding information
			if (el.LINK != null) track.href = el.LINK;
			trackImage.src = el.ICON ?? "./assets/playlistnoimage.png";
			if (el.NAME != null) {
				trackName.innerHTML = el.NAME;
				trackText.append(trackName);
			}
			if (el.ARTIST != null) {
				trackArtist.innerHTML = el.ARTIST;
				trackText.append(trackArtist);
			}
			return el.NAME == null && el.ARTIST == null ? null : track;
		});
	playlist.textContent = "";
	playlistTracks.filter(el => el !== null).forEach(el => playlist.append(el));
}
// #endregion
</script>

</body>
</html>